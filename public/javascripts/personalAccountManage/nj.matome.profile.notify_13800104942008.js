$.widget("matome.messageDialog",
	 {options:{onClose:$.noop,onSubmit:$.noop,onCancel:$.noop},
	  _create:function(){
	      var that=this;
	      this.element.find(".FnMessageDialogSubmit").click(function(){
		  var o={},$choice=that.element.find("[name=FnDialogChoice]"),sText=that.element.find("TEXTAREA").val();
		  if($choice.length){o.service=$choice.filter(":checked").val()||false;
				    }
		  o.text=sText;
		  that.options.onSubmit(o);
		  that.close();
		  return false;
	      });
	      this.element.find(".FnCancel").click(function(){that.options.onCancel();
							      that.close();
							      return false;
							     });
	      this.element.find(".FnClose").click(function(){that.options.onClose();
							     that.close();
							     return false;
							    });
	  },open:function(modalOption){this.element.njModal(modalOption);
				      },close:function(){this.element.njModal.close();
							 this.element.remove();
							}});

(function($){if($.fn.njModal&&$.fn.njModal._isDefine){return;
}var _$overlay,_$target,_fClose,_nMemberNum=2,_nModalIndex=10000,OVERLAY_ID="FnModalOverlay",OVERLAY_ID_SELECTOR="#"+OVERLAY_ID,OVERLAY_STYLE={position:"fixed",top:"0",left:"0",height:"100%",width:"100%",background:"#000",display:"none"},OVERLAY_RESET_STYLE={display:"block",opacity:0},OVERLAY_TEMPLATE='<div id="'+OVERLAY_ID+'"></div>',TARGET_CLASS="FnModal",TARGET_STYLE={display:"block",position:"fixed",top:"50%",left:"50%"},DEFAULT_OPTIONS={overlay:0.5,overlayClose:true,onClose:$.noop},OVERLAY_CLOSE_EVENT_NAME="click.njModal.overlayClose";
function modal(options){var nHeight,nWidth;
options=$.extend({},DEFAULT_OPTIONS,options);
_$target=$(this);
_fClose=options.onClose;
if(!_$overlay){_$overlay=$(OVERLAY_TEMPLATE);
_$overlay.css(OVERLAY_STYLE).appendTo(document.body);
}_$overlay.unbind(OVERLAY_CLOSE_EVENT_NAME);
if(options.overlayClose){_$overlay.bind(OVERLAY_CLOSE_EVENT_NAME,function(){$.fn.njModal.close();
});
}if(!_$target.hasClass(TARGET_CLASS)){nHeight=_$target.outerHeight();
nWidth=_$target.outerWidth();
_$target.addClass(TARGET_CLASS).css($.extend({},TARGET_STYLE,{marginTop:-(nHeight/2)+"px",marginLeft:-(nWidth/2)+"px"}));
}$(OVERLAY_ID_SELECTOR).css(OVERLAY_RESET_STYLE).fadeTo(0,options.overlay);
_$overlay.css("z-index",_nModalIndex);
_$target.css("z-index",_nModalIndex+1).show();
_nModalIndex+=_nMemberNum;
_nMemberNum++;
return this;
}modal.close=function(){$("#FnModalOverlay").hide();
_$target.css({display:"none"});
_fClose();
};
$.fn.extend({njModal:modal});
if(!$.browser.mozilla&&!$.browser.opera){(function(){var ex=function(){modal.apply(this,arguments);
_$target.njLayerSupport();
return this;
};
ex.close=function(){_$target.njLayerSupport("remove");
modal.close.apply(_$target[0],arguments);
};
$.fn.extend({njModal:ex});
})();
}$.fn.njModal._isDefine=true;
})(jQuery);
(function($){var LAYER_CLASS="FnLayerSupportOverlay";
$.widget("ui.njLayerSupport",{_init:function(){if(!$.browser.msie){return;
}if(($("embed").length||$("object").length)&&!this.element.find("."+LAYER_CLASS).length){this._setIframe();
}},_setIframe:function(){var $iframe=$("<iframe></iframe>"),$el,sPos;
this._$iframe&&this._$iframe.remove();
$iframe.attr({frameborder:0,scrolling:"no"}).css({width:"100%",height:"100%",position:"absolute",top:0,left:0,background:"#000",opacity:"-1000"}).addClass(LAYER_CLASS);
this.element.children().each(function(){$el=$(this);
sPos=$el.css("position");
if(sPos!=="absolute"){$el.css("position","relative").data("beforePosition",sPos);
}});
this.element.prepend($iframe);
this._$iframe=$iframe;
},remove:function(){var $el,sPos;
this._$iframe&&this._$iframe.remove();
this.element.children().each(function(){$el=$(this);
sPos=$el.data("beforePosition");
$el.css("position",sPos).data("beforePosition","");
});
}});
})(jQuery);
(function(){var messages={DIALOG_TITLE:"まとめ参加への招待",SERVER_ERROR:"一時的な問題により、アクセスできません。しばらくしてからもう一度お試しください。",CANCEL:"このまとめへの参加は取り消されました。"};
nj.getPackage("nj.matome.group.inviteNotify",{options:{base:".ArMain01"},init:function(options){options=options||{};
$.extend(true,this.options,options);
this._getElements();
this._attachEvents();
},_getElements:function(){this._$base=$(this.options.base);
},_attachEvents:function(){this._$base.delegate(".FnInviteNotifyButton","click",$.proxy(this._check,this));
},_check:function(e){var $el=$(e.target),sMissionId,that=this;
$el[0].tagName==="EM"&&($el=$el.parent());
sMissionId=$el.attr("data-missionid");
$.rest("GET",{url:nj.common.getAPI("GROUP_STATUS",{missionId:sMissionId}),success:function(o){if(o&&o.result){that._ask(o.result);
}else{alert(messages.SERVER_ERROR);
}}});
return false;
},_ask:function(oData){var that=this;
if(oData.statusCode==="J"){nj.matome.group.template("dialog",{type:"invite",title:messages.DIALOG_TITLE,name:oData.userNick,message:oData.description,image:oData.profileImageUrl}).messageDialog({onSubmit:function(){location.href=oData.nextUrl;
}}).messageDialog("open");
}else{if(oData.statusCode==="V"||oData.statusCode==="A"){alert(messages.CANCEL);
}else{oData.nextUrl?(location.href=oData.nextUrl):location.reload();
}}}});
})();
(function(){var TEMPLATE={dialog:'{{if type == "inviter"}}<div class="MdLayer09" data-na="NA:msgdialoginviter">{{else}}<div class="MdLayer08"{{if type == "choice"}} style="width:313px;"{{/if}} data-na="NA:msgdialog${type}">{{/if}}{{if type == "inviter"}}<div class="mdLayer09Inner01"><a href="/mymatome/${name}" target="_blank" data-na="NL:thumb"><img src="${image}#" alt="${name}さん" class="mdLayer09Inner01Thumb" onerror="errorImage(this,\'user40x40\');"></a><p class="mdLayer09Inner01Txt01"><a href="/mymatome/${name}" target="_blank" class="mdLayer09Inner01Username" data-na="NL:usernick">${name}</a>さんから招待された<span class="mdLayer09Inner01MTMTtl">まとめ</span>に参加します。</p><!--/mdLayer09Inner01--></div><div class="mdLayer09Inner02"><p class="mdLayer09Txt02">このまとめに参加することで、アイテムの追加や並べ替えなど、まとめを一緒に編集することができます。</p><p class="mdLayer09Btn01"><a class="mdLayer09BtnOK FnMessageDialogSubmit" href="#" data-na="NC:submit">OK</a></p><p class="mdLayer09Txt03"><a href="http://naverland.naver.jp/?p=2657" target="_blank" data-na="NL:help">NAVERまとめとは</a></p><!--/mdLayer09Inner02--></div>{{else}}{{if type == "choice"}}<dl><dt class="mdLayer08Hl01">招待を受けたサービスを選択</dt><dd class="mdLayer08Inner01"><ul class="mdLayer08Ul01"><li class="mdLayer08Ul01Li" data-na="NC:facebook"><input type="radio" id="ChoosingServiceSelect01" name="FnDialogChoice" value="facebook"><label for="ChoosingServiceSelect01" class="MdLabelTxt01"><span class="MdIco01Service01Fb"></span>Facebook</label></li><li class="mdLayer08Ul01Li" data-na="NC:twitter"><input type="radio" id="ChoosingServiceSelect02" name="FnDialogChoice" value="twitter"><label for="ChoosingServiceSelect02" class="MdLabelTxt01"><span class="MdIco01Service01Twtr"></span>Twitter</label></li></ul></dd></dl>{{else}}<p class="mdLayer08Hl01">${title}</p>{{if type == "join"}}<dl class="mdLayer08Inner01"><dt class="mdLayer08Txt01"><span class="mdLayer08Txt01Ico01"></span><a href="/mymatome/${name}" target="_blank" class="mdLayer08Username01" data-na="NL:usernick">${name}</a>さんにメッセージを送信</dt><dd class="mdLayer08Form01"><textarea class="mdLayer08Form01Input">${message}</textarea></dd><dd class="mdLayer08Txt02">${caution}</dd></dl>{{else}}<dl class="mdLayer08Inner01"><dt class="mdLayer08User01"><a href="/mymatome/${name}" target="_blank" class="mdLayer08Username01" data-na="NL:user"><img src="${image}#" alt="" class="mdLayer08User01Thumb" onerror="errorImage(this,\'user40x40\');">${name}</a>さん</dt><dd class="mdLayer08Message01"><p class="mdLayer08Message01Inner">${message}</p></dd></dl>{{/if}}{{/if}}<p class="mdLayer08Btn01">{{if type == "join"}}<span class="MdBtn01Send01"><a class="mdBtn01Send01Btn FnMessageDialogSubmit" href="#" data-na="NC:submit">送信する</a></span><span class="MdBtn01Cancel01"><a class="mdBtn01Cancel01Btn FnCancel" href="#" data-na="NC:cancel">キャンセル</a></span>{{else type == "request"}}<span class="MdBtn01Accept01"><a class="mdBtn01Accept01Btn FnMessageDialogSubmit" href="#" data-na="NC:submit"></a></span><span class="MdBtn01Hold01"><a class="mdBtn01Hold01Btn FnCancel" href="#" data-na="NC:cancel">保留する</a></span>{{else type == "invite"}}<span class="MdBtn01Join01"><a class="mdBtn01Join01Btn FnMessageDialogSubmit" href="#" data-na="NC:submit">参加する</a></span><span class="MdBtn01Hold01"><a class="mdBtn01Hold01Btn FnCancel" href="#" data-na="NC:cancel">保留する</a></span>{{else type == "choice"}}<span class="MdBtn01OK01"><a class="mdBtn01OK01Btn FnMessageDialogSubmit" href="#" data-na="NC:submit">OK</a></span><span class="MdBtn01Cancel01"><a class="mdBtn01Cancel01Btn FnCancel" href="#" data-na="NC:cancel">キャンセル</a></span>{{/if}}</p><p class="mdLayer08Btn02"><span class="MdBtn01Close05"><a title="閉じる" class="mdBtn01Close05Btn FnClose" href="#" data-na="NC:close">閉じる</a></span></p>{{/if}}<!--/MdLayer08--></div>'};
nj.getPackage("nj.matome.group.template",function(sType,option){var $tmp=$.tmpl(TEMPLATE[sType],option);
$tmp.appendTo(document.body);
return $tmp;
});
})();


/* @release 1380010682 */
